<html>
<head>
	<script type="text/javascript" charset="utf-8" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.min.js">	</script>
	<script type="text/javascript" charset="utf-8" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.6/jquery-ui.min.js">	</script>
<script type="text/javascript" charset="utf-8">
$(function(){
	var editing_nodes = [];
	$(function(){
		$("#editor .edit_link").show();
		$("#editor .save_links").hide();
	})
	$(".editable").live("mouseover",function(){
		node = $(this);
		var offset = node.offset();
		offset.top += node.height();
		$("#editor").offset(offset).show();
	});
	$(".editable").live("mouseleave",function(){
		if (typeof(editing_nodes[edname(this)]) != "undefined") {

			ednode = editing_nodes[edname(this)]
			var new_html = ednode.editor.getContent();
			ednode.editor.removeInstance(edname(this));
			ednode.node.html(new_html);
			editing_nodes[edname(this)] = null;

		}
	});
	$(".editable").live("click",function(){
		if (typeof(editing_nodes[edname(this)]) == "undefined") {
			editing_nodes[edname(this)] = editableNode(this);
		}
	});
	$(".save_link").live("click",function(){
		return false;
	});
	$(".cancel_link").live("click",function(){
		node.html(html);
		$("#editor .edit_link").show();
		$("#editor .save_links").hide();		
		return false;
	});

});

function editableNode(node) {
	this.real = true;
	this.node = $(node);
	this.html = this.node.html();
	$(node).html("<textarea name='temp_editing' id='"+edname(node)+"'>"+this.html+"</textarea>");
	new nicEditor({fullPanel : true}).panelInstance(edname(node),{hasPanel : true});
	this.editor = nicEditors.findEditor(edname(node));
	return this;
};
function edname(node) {
	return "editor_for_"+$(node).attr("id")
};

</script>
<script src="http://js.nicedit.com/nicEdit-latest.js" type="text/javascript"></script>
<script type="text/javascript">bkLib.onDomLoaded(nicEditors.allTextAreas);</script>


<style type="text/css" media="screen">
	body {
		padding: 20px;
	}

	#editor {
		display: none;
	}
	.editable textarea {
		width: 100%;
	}
	b {
		color: blue;
	}
	i {
		color: green;
	}
	.save_links {
		margin-left: 100px;
	}
	.edit_on, .edit_off {
		color: blue;
		text-decoration: none;
	}
	.edit_on.active, .edit_off.active {
		font-weight: bold;
	}
</style>
</head>

<body>
	<div id="controls">
		edit is:
		<a href="#" class="edit_on">ON</a> / 
		<a href="#" class="edit_off active">OFF</a>
		<span class="save_links">
			<a href="#" class="save_link">save</a>
			<a href="#" class="cancel_link">cancel</a>
		</span>
	
	<div id="block_1" class="editable">
	<p>Nam vestibulum, arcu sodales feugiat consectetur, nisl orci bibendum elit, eu euismod magna sapien ut nibh. Donec semper quam scelerisque tortor dictum gravida. In hac habitasse platea dictumst. Nam pulvinar, odio sed rhoncus suscipit, sem diam ultrices mauris, eu consequat purus metus eu velit. Proin metus odio, aliquam eget molestie nec, gravida ut sapien. Phasellus quis est sed turpis sollicitudin venenatis sed eu odio. Praesent eget neque eu eros interdum malesuada non vel leo. Sed fringilla porta ligula egestas tincidunt. Nullam risus magna, ornare vitae varius eget, scelerisque a libero. Morbi eu porttitor ipsum. Nullam lorem nisi, posuere quis volutpat eget, luctus nec massa. Pellentesque aliquam lacinia tellus sit amet bibendum. Ut posuere justo in enim pretium scelerisque. Etiam ornare vehicula euismod. Vestibulum at risus augue. Sed non semper dolor. Sed fringilla consequat velit a porta. Pellentesque sed lectus pharetra ipsum ultricies commodo non sit amet velit. Suspendisse volutpat lobortis ipsum, in scelerisque nisi iaculis a. Duis pulvinar lacinia commodo. Integer in lorem id.</p>
	<p>Nam vestibulum, arcu sodales feugiat consectetur, nisl orci bibendum elit, eu euismod magna sapien ut nibh. Donec semper quam scelerisque tortor dictum gravida. In hac habitasse platea dictumst. Nam pulvinar, odio sed rhoncus suscipit, sem diam ultrices mauris, eu consequat purus metus eu velit. Proin metus odio, aliquam eget molestie nec, gravida ut sapien. Phasellus quis est sed turpis sollicitudin venenatis sed eu odio. Praesent eget neque eu eros interdum malesuada non vel leo. Sed fringilla porta ligula egestas tincidunt. Nullam risus magna, ornare vitae varius eget, scelerisque a libero. Morbi eu porttitor ipsum. Nullam lorem nisi, posuere quis volutpat eget, luctus nec massa. Pellentesque aliquam lacinia tellus sit amet bibendum. Ut posuere justo in enim pretium scelerisque. Etiam ornare vehicula euismod. Vestibulum at risus augue. Sed non semper dolor. Sed fringilla consequat velit a porta. Pellentesque sed lectus pharetra ipsum ultricies commodo non sit amet velit. Suspendisse volutpat lobortis ipsum, in scelerisque nisi iaculis a. Duis pulvinar lacinia commodo. Integer in lorem id.</p>
	<p>Nam vestibulum, arcu sodales feugiat consectetur, nisl orci bibendum elit, eu euismod magna sapien ut nibh. Donec semper quam scelerisque tortor dictum gravida. In hac habitasse platea dictumst. Nam pulvinar, odio sed rhoncus suscipit, sem diam ultrices mauris, eu consequat purus metus eu velit. Proin metus odio, aliquam eget molestie nec, gravida ut sapien. Phasellus quis est sed turpis sollicitudin venenatis sed eu odio. Praesent eget neque eu eros interdum malesuada non vel leo. Sed fringilla porta ligula egestas tincidunt. Nullam risus magna, ornare vitae varius eget, scelerisque a libero. Morbi eu porttitor ipsum. Nullam lorem nisi, posuere quis volutpat eget, luctus nec massa. Pellentesque aliquam lacinia tellus sit amet bibendum. Ut posuere justo in enim pretium scelerisque. Etiam ornare vehicula euismod. Vestibulum at risus augue. Sed non semper dolor. Sed fringilla consequat velit a porta. Pellentesque sed lectus pharetra ipsum ultricies commodo non sit amet velit. Suspendisse volutpat lobortis ipsum, in scelerisque nisi iaculis a. Duis pulvinar lacinia commodo. Integer in lorem id.</p>
	</div>
	
	<div id="block_2" class="editable">
		<ul>
			<li>Maecenas quis tortor arcu. Vivamus rutrum nunc non neque</li>
			<li>Phasellus quis est sed turpis sollicitudin venenatis sed</li>
			<li>Lorem ipsum dolor sit amet, consectetur</li>
			<li>Sed nec diam eu diam mattis viverra. Nulla fringilla, orci</li>
			<li>Nulla fringilla, orci ac euismod semper, magna diam porttitor mauris, quis</li>
			<li>Phasellus quis est sed turpis</li>
			<li>Nam vestibulum, arcu sodales feugiat</li>
			<li>Vivamus rutrum nunc non neque</li>
			<li>Maecenas quis tortor arcu. Vivamus</li>
			<li>Nulla fringilla, orci ac euismod</li>
			<li>Nulla fringilla, orci ac euismod</li>
		</ul>

	</div>
	<div id="editor">

	</div>
</body>
</html>